<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimalist Kadran Uygulaması</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    
    <style>
        /* SADE TASARIM İÇİN BASİT CSS */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Açık gri/beyaz arkaplan */
            color: #333; /* Koyu metin */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
        }

        /* Kadranın Kendi Stilleri (Daha sade renkler) */
        #gauge-needle {
            /* Kırmızı iğne */
            background-color: #dc2626 !important; 
            box-shadow: 0 0 5px rgba(220, 38, 38, 0.7);
        }
        
        #gauge-container > div:first-child {
            /* Beyaz arka plan, hafif gölge */
            background-color: #ffffff !important;
            border: 1px solid #ddd !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        #gauge-container > div:last-child {
            /* Merkez noktası */
            background-color: #333 !important;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        /* Düğme ve Kaydırıcı Renkleri */
        #activate-button {
            background-color: #10b981 !important; /* Yeşil düğme */
            color: white !important;
            border: none !important;
            font-size: 1.1rem;
        }
        
        /* Kaydırıcı (Slider) Başı */
        #volume-slider::-webkit-slider-thumb, #volume-slider::-moz-range-thumb {
            background: white; 
            border: 2px solid #10b981; /* Yeşil çerçeve */
            box-shadow: 0 0 5px rgba(16, 185, 129, 0.7);
        }
    </style>
</head>
<body>

    <div class="w-full max-w-sm mx-auto flex flex-col items-center justify-center">

        <p id="frequency-display" class="text-4xl font-extrabold mb-10 text-gray-800">
            440.00 Hz - A4
        </p>

        <div id="gauge-container" class="relative w-64 h-64 mx-auto mb-10">
            
            <div class="absolute inset-0 rounded-full" ></div>
            
            <div id="gauge-needle" class="absolute left-1/2 top-1/2 -ml-0.5 -mt-20 w-1 h-20 rounded-full" 
                 style="transform-origin: bottom center; transform: rotate(12deg); transition: transform 0.1s linear;">
            </div>
            
            <div class="absolute left-1/2 top-1/2 -ml-3 -mt-3 w-6 h-6 rounded-full" ></div>
            
        </div>

        <button id="activate-button" class="py-3 px-12 font-bold rounded-lg shadow-md transition duration-300 transform active:scale-95 mx-auto block mb-6">
            Pause <span class="ml-2">||</span>
        </button>

        <div class="w-full px-4">
            <label for="volume-slider" class="block text-sm font-semibold mb-3 text-gray-700 text-center">
                Ses Şiddeti
            </label>
            <input type="range" id="volume-slider" min="0" max="100" value="70" class="w-full h-2 rounded-lg appearance-none cursor-pointer"
                style="background: linear-gradient(to right, #10b981 70%, #ccc 70%);">
        </div>
        
        <p class="text-xs mt-4 text-gray-500">
            Ses gelmiyorsa lütfen telefonunuzun Medya Sesini açın.
        </p>

    </div>

    <div id="data-display" style="display: none;"></div>

    <script>
        const activateButton = document.getElementById('activate-button');
        const dataDisplay = document.getElementById('data-display'); // Local storage için kullandığımız gizli element
        const gaugeNeedle = document.getElementById('gauge-needle');
        const volumeSlider = document.getElementById('volume-slider');
        const frequencyDisplay = document.getElementById('frequency-display');
        
        // Değişken tanımlamaları
        let isPaused = false;
        let currentValue = 70; 
        let needleInterval; 

        // --- Local Storage Fonksiyonları ---
        function loadSettings() {
            const savedVolume = localStorage.getItem('ritimAppVolume');
            const savedPaused = localStorage.getItem('ritimAppPaused');

            if (savedVolume !== null) {
                currentValue = parseInt(savedVolume);
                volumeSlider.value = currentValue;
            }

            if (savedPaused !== null) {
                isPaused = (savedPaused === 'true');
            }
        }

        function saveSettings() {
            localStorage.setItem('ritimAppVolume', currentValue.toString());
            localStorage.setItem('ritimAppPaused', isPaused.toString());
        }

        // --- Kadran/Görsel Fonksiyonlar ---
        
        function updateNeedle(value) {
            const minAngle = -60;
            const maxAngle = 60;
            const angle = minAngle + (value / 100) * (maxAngle - minAngle);
            gaugeNeedle.style.transform = `rotate(${angle}deg)`;
        }

        function updateFrequencyDisplay(value) {
            const minFreq = 380;
            const maxFreq = 500;
            const freqRange = maxFreq - minFreq;
            const currentFreq = minFreq + (value / 100) * freqRange;

            let noteName = "Harmonik";
            if (currentFreq < 400) { noteName = "F#3"; } 
            else if (currentFreq < 430) { noteName = "G4"; } 
            else if (currentFreq < 450) { noteName = "A4"; } 
            else if (currentFreq < 480) { noteName = "B4"; } 
            else { noteName = "C5"; }

            frequencyDisplay.textContent = `${currentFreq.toFixed(2)} Hz - ${noteName}`;
        }
        
        function startNeedleMovement() {
            if (needleInterval) clearInterval(needleInterval);

            needleInterval = setInterval(() => {
                const drift = (Math.random() * 6) - 3;
                let newValue = currentValue + drift;

                if (newValue < 0) newValue = 0;
                if (newValue > 100) newValue = 100;

                updateNeedle(newValue);
                updateFrequencyDisplay(newValue);

            }, 100);
        }

        function stopNeedleMovement() {
            if (needleInterval) {
                clearInterval(needleInterval);
                needleInterval = null;
                updateNeedle(currentValue); 
                updateFrequencyDisplay(currentValue);
            }
        }
        
        // --- BAŞLANGIÇ İŞLEMLERİ (Sayfa Yüklendiğinde Çalışır) ---
        
        // 1. Ayarları yükle
        loadSettings();

        // 2. Slider'ın görsel durumunu ve başlangıç metnini ayarla
        volumeSlider.style.background = `linear-gradient(to right, #10b981 ${currentValue}%, #ccc ${currentValue}%)`;
        
        // 3. Pause durumuna göre başlangıç durumunu ayarla
        if (!isPaused) {
            activateButton.innerHTML = 'Pause <span class="ml-2">||</span>';
            // Renkler zaten CSS'te ayarlandı
            startNeedleMovement();
        } else {
            activateButton.innerHTML = 'Aktif <span class="ml-2">▶</span>';
            // Renkler zaten CSS'te ayarlandı
            stopNeedleMovement();
        }
        
        // --- OLAY DİNLEYİCİLERİ ---

        activateButton.addEventListener('click', () => {
            isPaused = !isPaused;
            
            if (isPaused) {
                stopNeedleMovement();
                activateButton.innerHTML = 'Aktif <span class="ml-2">▶</span>';
            } else {
                startNeedleMovement();
                activateButton.innerHTML = 'Pause <span class="ml-2">||</span>';
            }
            
            saveSettings();
        });

        volumeSlider.addEventListener('input', (e) => {
            currentValue = parseInt(e.target.value);
            
            volumeSlider.style.background = `linear-gradient(to right, #10b981 ${currentValue}%, #ccc ${currentValue}%)`;
            
            if (isPaused) {
                updateNeedle(currentValue); 
                updateFrequencyDisplay(currentValue);
            }
            
            saveSettings();
        });
    </script>

</body>
</html>
